var Utils=function(){var n;return{getData:function(e){n=e},getBarData:function(){var e={labels:[],series:[]},a=[];return n.children.forEach(function(n){e.labels.push(n.name),a.push(n.children.length)}),e.series.push({label:"Projects count",values:a}),e},getStackData:function(){var e={name:"repos",languages:[]};return n.children.forEach(function(n){if("null"!==n.name){var a={language:n.name,count:n.children.length};e.languages.push(a)}}),[e]},getTreeData:function(){return n}}}();
var Searcher=function(){var t,e,r,i,n="",s=[],c={q:"bitcoin",sort:"forks",order:"desc",per_page:100};return{settings:{baseApiUrl:"https://api.github.com/search/repositories"},init:function(){e=d3.select("#search-input"),r=d3.select("#search-btn"),i=d3.select("#search-msg"),t=this.settings.baseApiUrl,r.on("click",function(){!function(){c.q=e.property("value")||"bitcoin";var r=[];for(var s in c)r.push(s+"="+c[s]);n=t+"?"+r.join("&"),console.log(n),i.text("当前搜索地址: "+n)}(),s.forEach(function(t){try{t(n)}catch(t){console.log(t)}})})},addListener:function(t){s.push(t)}}}();
var Bar=function(){function t(){d=[],r=Utils.getBarData(),l=s*r.series.length,function(t){for(var e=0;e<t.labels.length;e++)for(var r=0;r<t.series.length;r++)d.push(t.series[r].values[e])}(r);var t=d3.scale.category20(),e=s*d.length+i*r.labels.length,u=d3.scale.linear().domain([0,d3.max(d)]).range([0,n]),g=d3.scale.linear().range([e+i,0]);a=d3.svg.axis().scale(g).tickFormat("").tickSize(0).orient("left");var h=chart.attr("width",c+n+o).attr("height",e),f=h.selectAll("g").data(d,function(t,e){return[t,e]}),p=f.enter().append("g").attr("transform",function(t,e){return"translate("+c+","+(e*s+i*(.5+Math.floor(e/r.series.length)))+")"});p.append("rect").attr("fill",function(e,a){return t(a%r.series.length)}).attr("class","bar").attr("width",u).attr("height",s-1),p.append("text").attr("x",function(t){return u(t)-3}).attr("y",s/2).attr("fill","red").attr("dy",".35em").text(function(t){return t}),p.append("text").attr("class","label").attr("x",function(t){return-10}).attr("y",l/2).attr("dy",".35em").text(function(t,e){return e%r.series.length==0?r.labels[Math.floor(e/r.series.length)]:""}),f.exit().transition().style({opacity:0}).remove(),h.append("g").attr("class","y axis").attr("transform","translate("+c+", "+-i/2+")").call(a);var x=h.selectAll(".legend").data(r.series),b=x.enter().append("g").attr("transform",function(t,e){return"translate("+(c+n+40-18)+","+(22*e- -i/2)+")"});b.append("rect").attr("width",18).attr("height",18).style("fill",function(e,r){return t(r)}).style("stroke",function(e,r){return t(r)}),b.append("text").attr("class","legend").attr("x",22).attr("y",14).text(function(t){return t.label}),x.exit().remove()}var e,r,a,n=300,s=20,l=0,i=10,c=150,o=150,d=[];return{settings:{title:"barTitle",desc:"barDesc",barId:"#barId"},init:function(){e=this.settings.barId,d3.select("#barTitle").text(this.settings.title),d3.select("#barDesc").text(this.settings.desc),chart=d3.select(e).append("svg").attr("class","chart")},show:function(){t()}}}();
var Treemap=function(){function t(t){return t.watchers_count}function e(t){return t.forks_count}function n(t){var e=c/t.dx,n=s/t.dy;o.domain([t.x,t.x+t.dx]),u.domain([t.y,t.y+t.dy]);var r=i.selectAll("g.cell").transition().duration(d3.event.altKey?7500:750).attr("transform",function(t){return"translate("+o(t.x)+","+u(t.y)+")"});r.select("rect").attr("width",function(t){return e*t.dx-1}).attr("height",function(t){return n*t.dy-1}),r.select("text").attr("x",function(t){return 2*e*t.dx/3+20}).attr("y",function(t){return n*t.dy/2}).style("opacity",function(t){return 1}),f=t,d3.event.stopPropagation()}var r,a,i,c=970,s=500,o=d3.scale.linear().range([0,c]),u=d3.scale.linear().range([0,s]),l=d3.scale.category20c(),d=[],f=[];return{settings:{title:"treemapTitle",desc:"treemapDesc",treemapId:"#treemapId"},init:function(){var t=this.settings.treemapId;d3.select("#treemapTitle").text(this.settings.title),d3.select("#treemapDesc").text(this.settings.desc),r=d3.select(t).append("div").attr("class","chart").style("width",c+"px").style("height",s+"px"),i=r.append("svg").attr("width",c).attr("height",s).append("g").attr("transform","translate(.5,.5)"),a=d3.layout.treemap().size([c,s]).value(function(t){return t.watchers_count})},show:function(r){!function(r){f=d=Utils.getTreeData(r);var c=a.nodes(d).filter(function(t){return!t.children}),s=i.selectAll("g").data(c,function(t){return t.watchers_count}).enter().append("g").attr("class","cell").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).on("click",function(t){return n(f==t.parent?d:t.parent)});s.append("rect").attr("width",function(t){return t.dx-1}).attr("height",function(t){return t.dy-1}).style("fill",function(t){return l(t.parent.name)}),s.append("text").attr("x",function(t){return 2*t.dx/3+20}).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","middle").text(function(t){return t.name}).style("opacity",function(t){return t.w=this.getComputedTextLength(),1}),i.selectAll("g").data(c).exit().transition().style({opacity:0}).remove(),d3.select(window).on("click",function(){n(d)}),d3.select("#treemapSelect").on("change",function(){a.value("watchers"==this.value?t:e).nodes(d),n(f)})}(r)}}}();
!function(){function e(e){var a=setTimeout(function(){t.style.display="block"},300);e=e||"http://localhost:3000/search",d3.json(e,function(e,i){e&&(clearTimeout(a),t.style.display="none",alert("加载数据失败，请检查您的网络设置。")),Utils.getData(i),Bar.show(),Treemap.show(),clearTimeout(a),t.style.display="none"})}var t=document.getElementById("modal");Searcher.init(),Bar.settings={title:"Top100 BarChart",desc:"This is a good example.",barId:"#barId"},Bar.init(),Treemap.settings={title:"Top100 treemap",desc:"You can click the block to zoom it.",treemapId:"#sacdlTreemap"},Treemap.init(),Searcher.addListener(function(t){e(t)}),e()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwic2VhcmNoZXIuanMiLCJiYXIuanMiLCJ0cmVlbWFwLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIlV0aWxzIiwidHJlZURhdGEiLCJnZXREYXRhIiwiZGF0YSIsImdldEJhckRhdGEiLCJyZXN1bHQiLCJsYWJlbHMiLCJzZXJpZXMiLCJ2YWx1ZXMiLCJjaGlsZHJlbiIsImZvckVhY2giLCJpdGVtIiwicHVzaCIsIm5hbWUiLCJsZW5ndGgiLCJsYWJlbCIsImdldFN0YWNrRGF0YSIsImxhbmd1YWdlcyIsImNoaWxkIiwibGFuZ3VhZ2UiLCJjb3VudCIsImdldFRyZWVEYXRhIiwiU2VhcmNoZXIiLCJiYXNlQXBpVXJsIiwiaW5wdXRUeHQiLCJzZWFyY2hCdG4iLCJzZWFyY2hNc2ciLCJ1cmwiLCJsaXN0ZW5lcnMiLCJxdWVyeSIsInEiLCJzb3J0Iiwib3JkZXIiLCJwZXJfcGFnZSIsInNldHRpbmdzIiwiaW5pdCIsImQzIiwic2VsZWN0IiwidGhpcyIsIm9uIiwicHJvcGVydHkiLCJhcnIiLCJrZXkiLCJqb2luIiwiY29uc29sZSIsImxvZyIsInRleHQiLCJwYXJzZVF1ZXJ5IiwibGlzdGVuZXIiLCJlcnJvciIsImFkZExpc3RlbmVyIiwiQmFyIiwic2hvd0JhciIsInppcHBlZERhdGEiLCJncm91cEhlaWdodCIsImJhckhlaWdodCIsImkiLCJqIiwiemlwcGluZ0RhdGEiLCJjb2xvciIsInNjYWxlIiwiY2F0ZWdvcnkyMCIsImNoYXJ0SGVpZ2h0IiwiZ2FwQmV0d2Vlbkdyb3VwcyIsIngiLCJsaW5lYXIiLCJkb21haW4iLCJtYXgiLCJyYW5nZSIsImNoYXJ0V2lkdGgiLCJ5IiwieUF4aXMiLCJzdmciLCJheGlzIiwidGlja0Zvcm1hdCIsInRpY2tTaXplIiwib3JpZW50IiwiY2hhcnQiLCJhdHRyIiwic3BhY2VGb3JMYWJlbHMiLCJzcGFjZUZvckxlZ2VuZCIsImJhck5vZGVzIiwic2VsZWN0QWxsIiwiZCIsImJhciIsImVudGVyIiwiYXBwZW5kIiwiTWF0aCIsImZsb29yIiwiZXhpdCIsInRyYW5zaXRpb24iLCJzdHlsZSIsIm9wYWNpdHkiLCJyZW1vdmUiLCJjYWxsIiwibGVnZW5kRGF0YSIsImxlZ2VuZCIsImxlZ2VuZFJlY3RTaXplIiwiYmFySWQiLCJ0aXRsZSIsImRlc2MiLCJzaG93IiwiVHJlZW1hcCIsIndhdGNoZXJzQ291bnQiLCJ3YXRjaGVyc19jb3VudCIsImZvcmtzQ291bnQiLCJmb3Jrc19jb3VudCIsInpvb20iLCJreCIsInciLCJkeCIsImt5IiwiaCIsImR5IiwidCIsImR1cmF0aW9uIiwiZXZlbnQiLCJhbHRLZXkiLCJub2RlIiwic3RvcFByb3BhZ2F0aW9uIiwidHJlZW1hcCIsImNhdGVnb3J5MjBjIiwicm9vdCIsInRyZWVtYXBJZCIsImxheW91dCIsInNpemUiLCJ2YWx1ZSIsIm5vZGVzIiwiZmlsdGVyIiwiY2VsbCIsInBhcmVudCIsImdldENvbXB1dGVkVGV4dExlbmd0aCIsIndpbmRvdyIsInNob3dDaGFydCIsImxvYWRlciIsInNldFRpbWVvdXQiLCJsb2FkaW5nIiwiZGlzcGxheSIsImpzb24iLCJlcnIiLCJjbGVhclRpbWVvdXQiLCJhbGVydCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLE1BQVMsV0FFVCxJQUFJQyxFQUdKLE9BQ0lDLFFBQVMsU0FBU0MsR0FDZEYsRUFBV0UsR0FlZkMsV0FBWSxXQUNSLElBQ0lDLEdBQ0lDLFVBQ0FDLFdBRUpDLEtBWUosT0FqQllQLEVBQVNRLFNBT2ZDLFFBQVEsU0FBU0MsR0FDbkJOLEVBQU9DLE9BQU9NLEtBQUtELEVBQUtFLE1BQ3hCTCxFQUFPSSxLQUFLRCxFQUFLRixTQUFTSyxVQUc5QlQsRUFBT0UsT0FBT0ssTUFDVkcsTUFBTyxpQkFDUFAsT0FBUUEsSUFHTEgsR0FVWFcsYUFBYyxXQUNWLElBRUlYLEdBQ0FRLEtBQU0sUUFDTkksY0FnQkosT0FwQlloQixFQUFTUSxTQVFmQyxRQUFRLFNBQVNDLEdBQ25CLEdB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LFFBQVMsV0FDMUJvRSxFQUFLZSxLQUdUdEYsR0FBR0MsT0FBTyxrQkFBa0JFLEdBQUcsU0FBVSxXQUNyQ2lGLEVBQVFNLE1BQW9CLFlBQWR4RixLQUFLd0YsTUFBc0J2QixFQUFnQkUsR0FBWXNCLE1BQU1MLEdBQzNFZixFQUFLVyxLQXRFTGUsQ0FBVWxJLEtBL0NSO0NDQWQsV0E0QkksU0FBU2tHLEVBQUsxRSxHQUNWLElBQUkyRyxFQUFTQyxXQUFXLFdBQ3BCQyxFQUFRN0MsTUFBTThDLFFBQVUsU0FDekIsS0FFSDlHLEVBQU1BLEdBQU8sK0JBRWJTLEdBQUdzRyxLQUFLL0csRUFBSyxTQUFTZ0gsRUFBS3hJLEdBQ25Cd0ksSUFDQUMsYUFBYU4sR0FDYkUsRUFBUTdDLE1BQU04QyxRQUFVLE9BQ3hCSSxNQUFNLHNCQUdWN0ksTUFBTUUsUUFBUUMsR0FFZGdELElBQUlrRCxPQUNKQyxRQUFRRCxPQUVSdUMsYUFBYU4sR0FDYkUsRUFBUTdDLE1BQU04QyxRQUFVLFNBL0NoQyxJQUFJRCxFQUFVTSxTQUFTQyxlQUFlLFNBS3RDekgsU0FBU2EsT0FLVGdCLElBQUlqQixVQUNBaUUsTUFBTyxrQkFDUEMsS0FBTSwwQkFDTkYsTUFBTyxVQUVYL0MsSUFBSWhCLE9BS0ptRSxRQUFRcEUsVUFDSmlFLE1BQU8saUJBQ1BDLEtBQU0sc0NBQ051QixVQUFXLGlCQUVmckIsUUFBUW5FLE9BMEJSYixTQUFTNEIsWUFBWSxTQUFTdkIsR0FDMUIwRSxFQUFLMUUsS0FHVDBFLElBeERKIiwiZmlsZSI6InNhY2RsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBVdGlscyA9IChmdW5jdGlvbigpe1xuICAgIC8v5bGA6YOo5Y+Y6YeP5a6a5LmJXG4gICAgdmFyIHRyZWVEYXRhO1xuXG4gICAgLy/lhazlhbHmlrnms5VcbiAgICByZXR1cm4ge1xuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB0cmVlRGF0YSA9IGRhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgRGF0YSBmb3JtYXQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICAgbGFiZWxzOiBbXG4gICAgICAgICAgICAgICAgICdjL2MrKycsICdweXRob24nLCAnamF2YXNjcmlwdCcsXG4gICAgICAgICAgICAgICAgICdqYXZhJywgJ3J1YnknLCAnaHRtbCdcbiAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgIHNlcmllczogW3tcbiAgICAgICAgICAgICAgICAgbGFiZWw6ICdQcm9qZWN0cyBjb3VudCcsXG4gICAgICAgICAgICAgICAgIHZhbHVlczogWzQsIDgsIDE1LCAxNiwgMjMsIDQyXSAvL2NvdW50c1xuICAgICAgICAgICAgIH1dXG4gICAgICAgICB9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRCYXJEYXRhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRyZWVEYXRhLmNoaWxkcmVuO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgc2VyaWVzOiBbXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gW107XG5cbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5sYWJlbHMucHVzaChpdGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJlc3VsdC5zZXJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdQcm9qZWN0cyBjb3VudCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXNcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICBbXG4gICAgICAgICB7IG5hbWU6IFwicmVwb3NcIiAsXG4gICAgICAgICAgIGxhbmd1YWdlczogWyAgeyBsYW5ndWFnZTogJ2pzJywgY291bnQ6IDMwMDAgfSxcbiAgICAgICAgICAgICAgICAgICAgIHsgbGFuZ3VhZ2U6ICdydWJ5JywgY291bnQ6IDEzMDAgfV1cbiAgICAgICAgXTtcbiAgICAgICAgICovXG4gICAgICAgIGdldFN0YWNrRGF0YTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0cmVlRGF0YS5jaGlsZHJlbjtcblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcInJlcG9zXCIsXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VzOiBbXVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLzEuIOehruWumuWIneWni+aVsOaNrlxuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gXCJudWxsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNvdW50OiBpdGVtLmNoaWxkcmVuLmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICByZXN1bHQubGFuZ3VhZ2VzLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgcmV0dXJuIFtyZXN1bHRdO1xuICAgICAgICB9LFxuICAgICAgICAvKiogRGF0YSBmb3JtYXQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImxhbmd1YWdlc1wiLFxuICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJqYXZhc2NyaXB0XCIsXG4gICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiaW1mbHkvbXlJREVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICBcIndhdGNoZXJzX2NvdW50XCI6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICBcImZvcmtzX2NvdW50XCI6IDUwXG4gICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0VHJlZURhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRyZWVEYXRhO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy/np4HmnInmlrnms5VcbiAgICBmdW5jdGlvbiBuYW1lKCl7fVxufSgpKSIsInZhciBTZWFyY2hlciA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgdXJsID0gJycsXG4gICAgICAgIGJhc2VBcGlVcmwsXG4gICAgICAgIGlucHV0VHh0LFxuICAgICAgICBzZWFyY2hCdG4sXG4gICAgICAgIHNlYXJjaE1zZyxcbiAgICAgICAgbGlzdGVuZXJzID0gW10sXG4gICAgICAgIHF1ZXJ5ID0ge1xuICAgICAgICAgICAgcTogJ2JpdGNvaW4nLFxuICAgICAgICAgICAgc29ydDogXCJmb3Jrc1wiLFxuICAgICAgICAgICAgb3JkZXI6IFwiZGVzY1wiLFxuICAgICAgICAgICAgcGVyX3BhZ2U6IDEwMFxuICAgICAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGJhc2VBcGlVcmw6ICdodHRwczovL2FwaS5naXRodWIuY29tL3NlYXJjaC9yZXBvc2l0b3JpZXMnXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpbnB1dFR4dCA9IGQzLnNlbGVjdCgnI3NlYXJjaC1pbnB1dCcpO1xuICAgICAgICAgICAgc2VhcmNoQnRuID0gZDMuc2VsZWN0KCcjc2VhcmNoLWJ0bicpO1xuICAgICAgICAgICAgc2VhcmNoTXNnID0gZDMuc2VsZWN0KCcjc2VhcmNoLW1zZycpXG5cbiAgICAgICAgICAgIGJhc2VBcGlVcmwgPSB0aGlzLnNldHRpbmdzLmJhc2VBcGlVcmw7XG5cbiAgICAgICAgICAgIHNlYXJjaEJ0bi5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwYXJzZVF1ZXJ5KCk7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyKHVybCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRMaXN0ZW5lcjogZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBwYXJzZVF1ZXJ5KCkge1xuICAgICAgICBxdWVyeS5xID0gaW5wdXRUeHQucHJvcGVydHkoJ3ZhbHVlJykgfHwgJ2JpdGNvaW4nO1xuICAgICAgICB2YXIgYXJyID0gW107XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIHF1ZXJ5KSB7XG4gICAgICAgICAgICBhcnIucHVzaChrZXkgKyAnPScgKyBxdWVyeVtrZXldKTtcbiAgICAgICAgfTtcblxuICAgICAgICB1cmwgPSBiYXNlQXBpVXJsICsgJz8nICsgYXJyLmpvaW4oJyYnKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh1cmwpO1xuICAgICAgICBzZWFyY2hNc2cudGV4dCgn5b2T5YmN5pCc57Si5Zyw5Z2AOiAnICsgdXJsKTtcbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG59KCkpXG4iLCJ2YXIgQmFyID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBjaGFydFdpZHRoID0gMzAwLFxuICAgICAgICBiYXJIZWlnaHQgPSAyMCxcbiAgICAgICAgZ3JvdXBIZWlnaHQgPSAwLFxuICAgICAgICBnYXBCZXR3ZWVuR3JvdXBzID0gMTAsXG4gICAgICAgIHNwYWNlRm9yTGFiZWxzID0gMTUwLFxuICAgICAgICBzcGFjZUZvckxlZ2VuZCA9IDE1MCxcbiAgICAgICAgYmFySWQsXG4gICAgICAgIHN2ZyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgeUF4aXM7XG5cbiAgICAvLyBaaXAgdGhlIHNlcmllcyBkYXRhIHRvZ2V0aGVyIChmaXJzdCB2YWx1ZXMsIHNlY29uZCB2YWx1ZXMsIGV0Yy4pXG4gICAgdmFyIHppcHBlZERhdGEgPSBbXTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICB0aXRsZTogXCJiYXJUaXRsZVwiLFxuICAgICAgICAgICAgZGVzYzogXCJiYXJEZXNjXCIsXG4gICAgICAgICAgICBiYXJJZDogXCIjYmFySWRcIlxuICAgICAgICB9LFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYmFySWQgPSB0aGlzLnNldHRpbmdzLmJhcklkO1xuXG4gICAgICAgICAgICBkMy5zZWxlY3QoXCIjYmFyVGl0bGVcIikudGV4dCh0aGlzLnNldHRpbmdzLnRpdGxlKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdChcIiNiYXJEZXNjXCIpLnRleHQodGhpcy5zZXR0aW5ncy5kZXNjKTtcblxuICAgICAgICAgICAgY2hhcnQgPSBkMy5zZWxlY3QoYmFySWQpLmFwcGVuZChcInN2Z1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNob3dCYXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHppcHBpbmdEYXRhKGRhdGEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxhYmVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRhLnNlcmllcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHppcHBlZERhdGEucHVzaChkYXRhLnNlcmllc1tqXS52YWx1ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd0JhcigpIHtcbiAgICAgICAgLy9DbGVhblxuICAgICAgICB6aXBwZWREYXRhID0gW107XG5cbiAgICAgICAgZGF0YSA9IFV0aWxzLmdldEJhckRhdGEoKTtcbiAgICAgICAgZ3JvdXBIZWlnaHQgPSBiYXJIZWlnaHQgKiBkYXRhLnNlcmllcy5sZW5ndGg7XG5cbiAgICAgICAgemlwcGluZ0RhdGEoZGF0YSk7XG5cbiAgICAgICAgLy8gQ29sb3Igc2NhbGVcbiAgICAgICAgdmFyIGNvbG9yID0gZDMuc2NhbGUuY2F0ZWdvcnkyMCgpO1xuICAgICAgICB2YXIgY2hhcnRIZWlnaHQgPSBiYXJIZWlnaHQgKiB6aXBwZWREYXRhLmxlbmd0aCArIGdhcEJldHdlZW5Hcm91cHMgKiBkYXRhLmxhYmVscy5sZW5ndGg7XG5cbiAgICAgICAgdmFyIHggPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgLmRvbWFpbihbMCwgZDMubWF4KHppcHBlZERhdGEpXSlcbiAgICAgICAgICAgIC5yYW5nZShbMCwgY2hhcnRXaWR0aF0pO1xuXG4gICAgICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKClcbiAgICAgICAgICAgIC5yYW5nZShbY2hhcnRIZWlnaHQgKyBnYXBCZXR3ZWVuR3JvdXBzLCAwXSk7XG5cbiAgICAgICAgeUF4aXMgPSBkMy5zdmcuYXhpcygpXG4gICAgICAgICAgICAuc2NhbGUoeSlcbiAgICAgICAgICAgIC50aWNrRm9ybWF0KCcnKVxuICAgICAgICAgICAgLnRpY2tTaXplKDApXG4gICAgICAgICAgICAub3JpZW50KFwibGVmdFwiKTtcblxuICAgICAgICB2YXIgc3ZnID0gY2hhcnRcbiAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgc3BhY2VGb3JMYWJlbHMgKyBjaGFydFdpZHRoICsgc3BhY2VGb3JMZWdlbmQpXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBjaGFydEhlaWdodCk7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBub2Rlc1xuICAgICAgICB2YXIgYmFyTm9kZXMgPSBzdmcuc2VsZWN0QWxsKFwiZ1wiKS5kYXRhKHppcHBlZERhdGEsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gW2QsIGldO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8vIENyZWF0ZSBiYXJzXG4gICAgICAgIHZhciBiYXIgPSBiYXJOb2Rlc1xuICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgc3BhY2VGb3JMYWJlbHMgKyBcIixcIiArIChpICogYmFySGVpZ2h0ICsgZ2FwQmV0d2Vlbkdyb3VwcyAqICgwLjUgKyBNYXRoLmZsb29yKGkgLyBkYXRhLnNlcmllcy5sZW5ndGgpKSkgKyBcIilcIjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSByZWN0YW5nbGVzIG9mIHRoZSBjb3JyZWN0IHdpZHRoXG4gICAgICAgIGJhci5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcihpICUgZGF0YS5zZXJpZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYmFyXCIpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHgpXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBiYXJIZWlnaHQgLSAxKTtcblxuICAgICAgICAvLyBBZGQgdGV4dCBsYWJlbCBpbiBiYXJcbiAgICAgICAgYmFyLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHgoZCkgLSAzO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwieVwiLCBiYXJIZWlnaHQgLyAyKVxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmVkXCIpXG4gICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLjM1ZW1cIilcbiAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERyYXcgbGFiZWxzXG4gICAgICAgIGJhci5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwibGFiZWxcIilcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xMDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcInlcIiwgZ3JvdXBIZWlnaHQgLyAyKVxuICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgICAgICAgICAudGV4dChmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgJSBkYXRhLnNlcmllcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmxhYmVsc1tNYXRoLmZsb29yKGkgLyBkYXRhLnNlcmllcy5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWxldGUgdGhlIGV4dHJhIG5vZGVzXG4gICAgICAgIGJhck5vZGVzLmV4aXQoKVxuICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLnN0eWxlKHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnJlbW92ZSgpO1xuXG4gICAgICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwieSBheGlzXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHNwYWNlRm9yTGFiZWxzICsgXCIsIFwiICsgLWdhcEJldHdlZW5Hcm91cHMgLyAyICsgXCIpXCIpXG4gICAgICAgICAgICAuY2FsbCh5QXhpcyk7XG5cbiAgICAgICAgLy8gRHJhdyBsZWdlbmRcbiAgICAgICAgdmFyIGxlZ2VuZFJlY3RTaXplID0gMTgsXG4gICAgICAgICAgICBsZWdlbmRTcGFjaW5nID0gNDtcblxuICAgICAgICB2YXIgbGVnZW5kRGF0YSA9IHN2Zy5zZWxlY3RBbGwoJy5sZWdlbmQnKVxuICAgICAgICAgICAgLmRhdGEoZGF0YS5zZXJpZXMpO1xuXG4gICAgICAgIHZhciBsZWdlbmQgPSBsZWdlbmREYXRhXG4gICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBsZWdlbmRSZWN0U2l6ZSArIGxlZ2VuZFNwYWNpbmc7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IC1nYXBCZXR3ZWVuR3JvdXBzIC8gMjtcbiAgICAgICAgICAgICAgICB2YXIgaG9yeiA9IHNwYWNlRm9yTGFiZWxzICsgY2hhcnRXaWR0aCArIDQwIC0gbGVnZW5kUmVjdFNpemU7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnQgPSBpICogaGVpZ2h0IC0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyBob3J6ICsgJywnICsgdmVydCArICcpJztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGxlZ2VuZC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgbGVnZW5kUmVjdFNpemUpXG4gICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgbGVnZW5kUmVjdFNpemUpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yKGkpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcihpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGxlZ2VuZC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xlZ2VuZCcpXG4gICAgICAgICAgICAuYXR0cigneCcsIGxlZ2VuZFJlY3RTaXplICsgbGVnZW5kU3BhY2luZylcbiAgICAgICAgICAgIC5hdHRyKCd5JywgbGVnZW5kUmVjdFNpemUgLSBsZWdlbmRTcGFjaW5nKVxuICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmxhYmVsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbGVnZW5kRGF0YS5leGl0KCkucmVtb3ZlKCk7XG4gICAgfVxufSgpKVxuIiwidmFyIFRyZWVtYXAgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSA5NzAsXG4gICAgICAgIGggPSA1MDAsXG4gICAgICAgIHggPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbMCwgd10pLFxuICAgICAgICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKSxcbiAgICAgICAgY29sb3IgPSBkMy5zY2FsZS5jYXRlZ29yeTIwYygpLFxuICAgICAgICByb290ID0gW10sXG4gICAgICAgIG5vZGUgPSBbXSxcbiAgICAgICAgY2hhcnQsXG4gICAgICAgIHRyZWVtYXAsXG4gICAgICAgIHN2ZztcblxuICAgIHJldHVybiB7XG4gICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICB0aXRsZTogXCJ0cmVlbWFwVGl0bGVcIixcbiAgICAgICAgICAgIGRlc2M6IFwidHJlZW1hcERlc2NcIixcbiAgICAgICAgICAgIHRyZWVtYXBJZDogXCIjdHJlZW1hcElkXCJcbiAgICAgICAgfSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0cmVlbWFwSWQgPSB0aGlzLnNldHRpbmdzLnRyZWVtYXBJZDtcblxuICAgICAgICAgICAgZDMuc2VsZWN0KFwiI3RyZWVtYXBUaXRsZVwiKS50ZXh0KHRoaXMuc2V0dGluZ3MudGl0bGUpO1xuICAgICAgICAgICAgZDMuc2VsZWN0KFwiI3RyZWVtYXBEZXNjXCIpLnRleHQodGhpcy5zZXR0aW5ncy5kZXNjKTtcblxuICAgICAgICAgICAgY2hhcnQgPSBkMy5zZWxlY3QodHJlZW1hcElkKS5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiY2hhcnRcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoXCJ3aWR0aFwiLCB3ICsgXCJweFwiKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcImhlaWdodFwiLCBoICsgXCJweFwiKVxuXG4gICAgICAgICAgICBzdmcgPSBjaGFydFxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJzdmdcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHcpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKC41LC41KVwiKTtcblxuICAgICAgICAgICAgdHJlZW1hcCA9IGQzLmxheW91dC50cmVlbWFwKClcbiAgICAgICAgICAgICAgICAvLyAucm91bmQoZmFsc2UpXG4gICAgICAgICAgICAgICAgLnNpemUoW3csIGhdKVxuICAgICAgICAgICAgICAgIC8vIC5zdGlja3koZmFsc2UpXG4gICAgICAgICAgICAgICAgLnZhbHVlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQud2F0Y2hlcnNfY291bnQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvdzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgc2hvd0NoYXJ0KGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd0NoYXJ0KGRhdGEpIHtcbiAgICAgICAgbm9kZSA9IHJvb3QgPSBVdGlscy5nZXRUcmVlRGF0YShkYXRhKTtcblxuICAgICAgICB2YXIgbm9kZXMgPSB0cmVlbWFwLm5vZGVzKHJvb3QpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWQuY2hpbGRyZW47XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB2YXIgY2VsbCA9IHN2Zy5zZWxlY3RBbGwoXCJnXCIpXG4gICAgICAgICAgICAuZGF0YShub2RlcywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLndhdGNoZXJzX2NvdW50O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImNlbGxcIilcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBkLnggKyBcIixcIiArIGQueSArIFwiKVwiO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gem9vbShub2RlID09IGQucGFyZW50ID8gcm9vdCA6IGQucGFyZW50KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGNlbGwuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuZHggLSAxO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5keSAtIDE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yKGQucGFyZW50Lm5hbWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgY2VsbC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyICogZC5keCAvIDMgKyAyMDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmR5IC8gMjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLjM1ZW1cIilcbiAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5uYW1lO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIGQudyA9IHRoaXMuZ2V0Q29tcHV0ZWRUZXh0TGVuZ3RoKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIGQuZHggPiBkLncgPyAxIDogMDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHN2Zy5zZWxlY3RBbGwoXCJnXCIpXG4gICAgICAgICAgICAuZGF0YShub2RlcylcbiAgICAgICAgICAgIC5leGl0KClcbiAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgIC5zdHlsZSh7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5yZW1vdmUoKTtcblxuICAgICAgICBkMy5zZWxlY3Qod2luZG93KS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgem9vbShyb290KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZDMuc2VsZWN0KFwiI3RyZWVtYXBTZWxlY3RcIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0cmVlbWFwLnZhbHVlKHRoaXMudmFsdWUgPT0gXCJ3YXRjaGVyc1wiID8gd2F0Y2hlcnNDb3VudCA6IGZvcmtzQ291bnQpLm5vZGVzKHJvb3QpO1xuICAgICAgICAgICAgem9vbShub2RlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2F0Y2hlcnNDb3VudChkKSB7XG4gICAgICAgIHJldHVybiBkLndhdGNoZXJzX2NvdW50O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcmtzQ291bnQoZCkge1xuICAgICAgICByZXR1cm4gZC5mb3Jrc19jb3VudDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB6b29tKGQpIHtcbiAgICAgICAgdmFyIGt4ID0gdyAvIGQuZHgsXG4gICAgICAgICAgICBreSA9IGggLyBkLmR5O1xuICAgICAgICB4LmRvbWFpbihbZC54LCBkLnggKyBkLmR4XSk7XG4gICAgICAgIHkuZG9tYWluKFtkLnksIGQueSArIGQuZHldKTtcblxuICAgICAgICB2YXIgdCA9IHN2Zy5zZWxlY3RBbGwoXCJnLmNlbGxcIikudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuZHVyYXRpb24oZDMuZXZlbnQuYWx0S2V5ID8gNzUwMCA6IDc1MClcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyB4KGQueCkgKyBcIixcIiArIHkoZC55KSArIFwiKVwiO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdC5zZWxlY3QoXCJyZWN0XCIpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga3ggKiBkLmR4IC0gMTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGt5ICogZC5keSAtIDE7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIHQuc2VsZWN0KFwidGV4dFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMiAqIGt4ICogZC5keCAvIDMgKyAyMDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcInlcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBreSAqIGQuZHkgLyAyO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBreCAqIGQuZHggPiBkLncgPyAxIDogMDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5vZGUgPSBkO1xuICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbn0oKSlcbiIsIihmdW5jdGlvbigpIHtcbiAgICB2YXIgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kYWxcIik7XG5cbiAgICAvKipcbiAgICAgKiBTZWFyY2hcbiAgICAgKi9cbiAgICBTZWFyY2hlci5pbml0KCk7XG5cbiAgICAvKipcbiAgICAgKiBzdGFydCBCYXJDaGFydFxuICAgICAqL1xuICAgIEJhci5zZXR0aW5ncyA9IHtcbiAgICAgICAgdGl0bGU6IFwiVG9wMTAwIEJhckNoYXJ0XCIsXG4gICAgICAgIGRlc2M6IFwiVGhpcyBpcyBhIGdvb2QgZXhhbXBsZS5cIixcbiAgICAgICAgYmFySWQ6IFwiI2JhcklkXCJcbiAgICB9XG4gICAgQmFyLmluaXQoKTtcblxuICAgIC8qKlxuICAgICAqIHN0YXJ0IHRyZWVtYXBcbiAgICAgKi9cbiAgICBUcmVlbWFwLnNldHRpbmdzID0ge1xuICAgICAgICB0aXRsZTogXCJUb3AxMDAgdHJlZW1hcFwiLFxuICAgICAgICBkZXNjOiBcIllvdSBjYW4gY2xpY2sgdGhlIGJsb2NrIHRvIHpvb20gaXQuXCIsXG4gICAgICAgIHRyZWVtYXBJZDogXCIjc2FjZGxUcmVlbWFwXCJcbiAgICB9XG4gICAgVHJlZW1hcC5pbml0KCk7XG5cbiAgICBmdW5jdGlvbiBzaG93KHVybCkge1xuICAgICAgICB2YXIgbG9hZGVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgfSwgMzAwKTtcblxuICAgICAgICB1cmwgPSB1cmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9zZWFyY2gnO1xuXG4gICAgICAgIGQzLmpzb24odXJsLCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGVyKTtcbiAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICBhbGVydChcIuWKoOi9veaVsOaNruWksei0pe+8jOivt+ajgOafpeaCqOeahOe9kee7nOiuvue9ruOAglwiKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgVXRpbHMuZ2V0RGF0YShkYXRhKTtcblxuICAgICAgICAgICAgQmFyLnNob3coKTtcbiAgICAgICAgICAgIFRyZWVtYXAuc2hvdygpO1xuXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGVyKTtcbiAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBTZWFyY2hlci5hZGRMaXN0ZW5lcihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgc2hvdyh1cmwpO1xuICAgIH0pXG5cbiAgICBzaG93KCk7XG59KSgpXG4iXX0=
